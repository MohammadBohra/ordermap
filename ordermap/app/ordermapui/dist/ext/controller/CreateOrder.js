sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox"],function(e,r){"use strict";return{create_sales_order:async function(s,o){try{if(!o||o.length===0){e.show("Please select a row to create SAP order.");return}const s=o[0];const n=s.getObject();const i=n.SapOrderId;const c=n.IdocNumber;const d=n.MessageType;const g=e=>e===null||e===undefined||e===""||typeof e==="string"&&/^0+$/.test(e);const m=this;const l=g(i)&&(g(c)||!g(c)&&d==="E");const f=!g(c)&&d==="E";if(f){r.confirm("Previous order submission failed.\n\nValidate the order details before submitting a new request. \n\n Do you want to submit a new reqtuest?",{title:"Confirm Order Creation",actions:[r.Action.NO,r.Action.YES],emphasizedAction:r.Action.NO,onClose:async function(e){if(e===r.Action.YES){if(l){const e=s.sPath;var o="";var a="";const t=e.match(/OrderId=(\d+),WebServiceID='([^']+)'/);if(t){o=t[1];a=t[2]}const n=s.getModel().bindContext("/create_sales_order(...)");n.setParameter("OrderId",o);n.setParameter("WebServiceID",a);n.setParameter("APIName",s.getObject().APIName);await n.execute().catch(function(e){let s="Order creation failed.";if(e?.error?.message){s=e.error.message}else if(e?.message){s=e.message}r.error(s);sap.ui.getCore().getMessageManager().removeAllMessages();return Promise.reject(e)});const i=n.getBoundContext().getObject();let c=i.payload;if(c.length===0){sap.m.MessageBox.error("Unknown error occurred. No response received.");return}let d;if(typeof c==="string"){try{d=JSON.parse(c)}catch(e){sap.m.MessageBox.error("Failed to parse response from server.");sap.ui.getCore().getMessageManager().removeAllMessages();return}}else if(Array.isArray(c)){d=c}else{sap.m.MessageBox.error("Invalid response format from server.");return}if(!d||d.length===0){sap.m.MessageBox.error("No response data received.");return}const g=d[0];const m=g.OrderNumber||"";const l=g.IDOCNumber||"";const f=g.MsgType;const u=g.message||"";if(!f){sap.m.MessageBox.error(`SAP Order creation for BigCommerce order ${m} failed.\n${u||"Unknown error occurred."}`)}else if(f==="S"){sap.m.MessageBox.success(`SAP IDoc created successfully for Bigcommerce order ${m}.\nIDoc Number: ${l||"N/A"}`)}else if(f==="E"){sap.m.MessageBox.error(`Order ${m} creation failed.\n${u||"Unknown error occurred."}`)}else{sap.m.MessageBox.information(`${u}`)}}else{if(!g(i)){sap.m.MessageBox.information(`SAP Order already exists.\nSAP Order Number: ${i}`)}else if(!g(c)){sap.m.MessageBox.information(`SAP Order creation is already in progress.\nIDoc Number: ${c}`)}else if(d&&d!=="E"){sap.m.MessageBox.information(`SAP Order creation cannot be triggered.\nCurrent Message Type: ${d}`)}else{sap.m.MessageBox.information("SAP Order creation cannot be triggered for the selected record.")}return}}}})}else{if(l){const e=s.sPath;var a="";var t="";const r=e.match(/OrderId=(\d+),WebServiceID='([^']+)'/);if(r){a=r[1];t=r[2]}const o=s.getModel().bindContext("/create_sales_order(...)");o.setParameter("OrderId",a);o.setParameter("WebServiceID",t);await o.execute();const n=o.getBoundContext().getObject();let i=n.payload;if(i.length===0){sap.m.MessageBox.error("Unknown error occurred. No response received.");return}let c;if(typeof i==="string"){try{c=JSON.parse(i)}catch(e){sap.m.MessageBox.error("Failed to parse response from server.");sap.ui.getCore().getMessageManager().removeAllMessages();return}}else if(Array.isArray(i)){c=i}else{sap.m.MessageBox.error("Invalid response format from server.");return}if(!c||c.length===0){sap.m.MessageBox.error("No response data received.");return}const d=c[0];const g=d.OrderNumber||"";const m=d.IDOCNumber||"";const l=d.MsgType;const f=d.message||"";if(!l){sap.m.MessageBox.error(`Order ${g} creation failed.\nUnknown error occurred.`)}else if(l==="S"){sap.m.MessageBox.success(`SAP IDoc created successfully for Order ${g}.\nIDoc Number: ${m||"N/A"}`)}else if(l==="E"){sap.m.MessageBox.error(`Order ${g} creation failed.\n${f||"Unknown error occurred."}`)}else{sap.m.MessageBox.error(`Order ${g} creation failed.\nUnexpected message type: ${l}`)}}else{if(!g(i)){sap.m.MessageBox.information(`SAP Order already exists.\nSAP Order Number: ${i}`)}else if(!g(c)){sap.m.MessageBox.information(`SAP Order creation is already in progress.\nIDoc Number: ${c}`)}else if(d&&d!=="E"){sap.m.MessageBox.information(`SAP Order creation cannot be triggered.\nCurrent Message Type: ${d}`)}else{sap.m.MessageBox.information("SAP Order creation cannot be triggered for the selected record.")}return}}}catch(e){r.error(e.error.message);sap.ui.getCore().getMessageManager().removeAllMessages()}}}});
//# sourceMappingURL=CreateOrder.js.map