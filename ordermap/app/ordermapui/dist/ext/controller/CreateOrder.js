sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox"],function(e,r){"use strict";return{create_sales_order:async function(s,o){try{if(!o||o.length===0){e.show("Please select a row to create SAP order.");return}const s=o[0];const a=s.getObject();const i=a.SapOrderId;const c=a.IdocNumber;const d=a.MessageType;const f=a.Message;const m=e=>e===null||e===undefined||e===""||typeof e==="string"&&/^0+$/.test(e);const g=this;const l=m(i)&&(m(c)||!m(c)&&d==="E");const u=!m(c)&&d==="E";if(u){r.confirm("Previous order submission failed.\n\nValidate the order details before submitting a new request. \n\n Do you want to submit a new reqtuest?",{title:"Confirm Order Creation",actions:[r.Action.NO,r.Action.YES],emphasizedAction:r.Action.NO,onClose:async function(e){if(e===r.Action.YES){if(l){const e=s.sPath;var o="";var t="";const n=e.match(/OrderId=(\d+),WebServiceID='([^']+)'/);if(n){o=n[1];t=n[2]}const a=s.getModel().bindContext("/create_sales_order(...)");a.setParameter("OrderId",o);a.setParameter("WebServiceID",t);a.setParameter("APIName",s.getObject().APIName);await a.execute().catch(function(e){let s="Order creation failed.";if(e?.error?.message){s=e.error.message}else if(e?.message){s=e.message}r.error(s);sap.ui.getCore().getMessageManager().removeAllMessages();return Promise.reject(e)});const i=a.getBoundContext().getObject();const c=i.SapOrderId||"";const d=i.IdocNumber||"";const f=i.MessageType;const m=i.Message||"";if(!f){r.error("Order creation failed. Unknown error occurred.")}else if(f==="S"){r.success(`SAP IDoc created successfully for BigCommerce order ${i.OrderId}.\nIDoc Number: ${d||"N/A"}`)}else if(f==="E"){r.error(`Order ${i.OrderId} creation failed.\n${m||"Unknown error occurred."}`)}else{r.information(m||"Unexpected response received.")}}else{if(!m(i)){r.information(`SAP order already exists.\nSAP order number: ${i}`)}else if(!m(c)){r.information(`SAP order creation is already in progress.\nIDoc number: ${c}`)}else if(d&&d!=="E"){r.information(`SAP order creation cannot be triggered.\nCurrent message type: ${f}`)}else{r.information("SAP Order creation cannot be triggered for the selected record.")}return}}}})}else{if(l){const e=s.sPath;var t="";var n="";const o=e.match(/OrderId=(\d+),WebServiceID='([^']+)'/);if(o){t=o[1];n=o[2]}const a=s.getModel().bindContext("/create_sales_order(...)");a.setParameter("OrderId",t);a.setParameter("WebServiceID",n);await a.execute();const i=a.getBoundContext().getObject();const c=i.SapOrderId||"";const d=i.IdocNumber||"";const f=i.MessageType;const m=i.Message||"";if(!f){r.error("Order creation failed. Unknown error occurred.")}else if(f==="S"){r.success(`SAP IDoc created successfully for BigCommerce order ${i.OrderId}.\nIDoc Number: ${d||"N/A"}`)}else if(f==="E"){r.error(`Order ${i.OrderId} creation failed.\n${m||"Unknown error occurred."}`)}else{r.information(m||"Unexpected response received.")}}else{if(!m(i)){sap.m.MessageBox.information(`SAP Order already exists.\nSAP Order Number: ${i}`)}else if(!m(c)){sap.m.MessageBox.information(`SAP Order creation is already in progress.\nIDoc Number: ${c}`)}else if(d&&d!=="E"){sap.m.MessageBox.information(`SAP Order creation cannot be triggered.\nMissing SAP information`)}else{sap.m.MessageBox.information("SAP Order creation cannot be triggered for the selected record.")}return}}}catch(e){r.error(e.error.message);sap.ui.getCore().getMessageManager().removeAllMessages()}}}});
//# sourceMappingURL=CreateOrder.js.map